<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<button class="btn btn-primary" onclick="done()">done / next</button>
<h1 id="name"></h1>

<div>this step just says hi</div>

<pre id="msg"></pre>


<script>
  // avoid some boilerplate 
  const app = {
    name: 'flow-step1',
    color: 'red'
  };
  document.getElementById('name').innerHTML = app.name;
  document.getElementById('name').style.backgroundColor = app.color;


  // actual app logic
  let appContext = {};

  window.addEventListener('message', (ev) => {
    document.getElementById('msg').innerHTML += `CTX => ${JSON.stringify(ev.data, null, 2)} \n`;
    appContext = ev.data.payload;
  });

  function done() {
    parent.postMessage({
      type: 'out-context',
      payload: { [app.name + '-result']: `hello ${appContext.global.userName} from ${app.name}!` }
    })
  }

  function start() {
    const data = { type: 'in-context', payload: null }
    parent.postMessage(data);
  }

  start();
</script>
<!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
<script type='text/javascript'>
  (function(){var g=function(e,h,f,g){
  this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
  this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
  this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
  this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g+ "&t=" + (new Date()).getTime();document.body&&document.body.appendChild(a)}};
  this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
  try{(new g(100,"r","QSI_S_ZN_bkAGtiSsofG6KiN","https://znbkagtissofg6kin-sapdevelopment.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_bkAGtiSsofG6KiN")).start()}catch(i){}})();
  </script><div id='ZN_bkAGtiSsofG6KiN'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
  <!--END WEBSITE FEEDBACK SNIPPET-->
